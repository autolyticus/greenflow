<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Requirements - GreenFlow documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="requirements.html" class="active"><strong aria-hidden="true">2.</strong> Requirements</a></li><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">3.</strong> System Overview</a></li><li class="chapter-item expanded "><a href="workflow.html"><strong aria-hidden="true">4.</strong> Workflow</a></li><li class="chapter-item expanded "><a href="prometheus-setup.html"><strong aria-hidden="true">5.</strong> Prometheus Setup</a></li><li class="chapter-item expanded "><a href="data-analysis.html"><strong aria-hidden="true">6.</strong> Data Analysis</a></li><li class="chapter-item expanded affix "><a href="project-info.html">Project Info</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">GreenFlow documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="requirements"><a class="header" href="#requirements">Requirements</a></h1>
<h2 id="local-project-setup"><a class="header" href="#local-project-setup">Local Project Setup</a></h2>
<p>Setting up the GreenFlow project locally is streamlined thanks to the use of Nix for dependency management and environment configuration. This approach ensures consistency across different development environments and simplifies the setup process.</p>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<p>Before you begin, ensure you have the following installed on your system:</p>
<ol>
<li><strong>Nix</strong>: We use the Determinate Systems Nix installer for a consistent setup.</li>
<li><strong>direnv</strong> (optional, recommended): This tool automatically loads and unloads environment variables based on the current directory.</li>
<li><strong>Docker</strong>: Required for running Docker Compose to set up Tailscale, Caddy, Prometheus, Victoria Metrics, and Grafana.</li>
<li><strong>Docker Compose</strong>: Used to manage multi-container Docker applications.</li>
</ol>
<h3 id="installation-steps"><a class="header" href="#installation-steps">Installation Steps</a></h3>
<ol>
<li>
<p><strong>Install Nix</strong> (if not already installed):</p>
<p>Use the Determinate Systems Nix installer by running the following command in your terminal:</p>
<pre><code class="language-bash">curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
</code></pre>
</li>
<li>
<p><strong>Install <code>direnv</code></strong>:</p>
<p>Installation methods may vary depending on your operating system. For most Unix-like systems, you can use your package manager. For example:</p>
<ul>
<li>On macOS with Homebrew:
<pre><code class="language-bash">brew install direnv
</code></pre>
</li>
<li>On Ubuntu or Debian:
<pre><code class="language-bash">sudo apt-get install direnv
</code></pre>
</li>
</ul>
<p>For other systems, refer to the <a href="https://direnv.net/docs/installation.html">direnv installation guide</a>.</p>
</li>
<li>
<p><strong>Install Docker</strong>:</p>
<p>Follow the <a href="https://docs.docker.com/get-docker/">official Docker installation guide</a> for your operating system.</p>
</li>
<li>
<p><strong>Install Docker Compose</strong>:</p>
<p>Follow the <a href="https://docs.docker.com/compose/install/">official Docker Compose installation guide</a> for your operating system.</p>
</li>
<li>
<p><strong>Clone the GreenFlow repository</strong>:</p>
<pre><code class="language-bash">git clone https://github.com/autolyticus/greenflow.git
cd greenflow
</code></pre>
</li>
<li>
<p><strong>Set up direnv</strong>:</p>
<pre><code class="language-bash">direnv allow
</code></pre>
<p>This command should automatically download and set up all required dependencies, including Ansible, Python, and any other project-specific tools.</p>
</li>
</ol>
<h3 id="verifying-the-setup"><a class="header" href="#verifying-the-setup">Verifying the Setup</a></h3>
<p>After running <code>nix develop</code>, your environment should be ready for GreenFlow development. You can verify the setup by running:</p>
<pre><code class="language-bash">python --version
ansible --version
</code></pre>
<p>These commands should display the versions of Python and Ansible specified in the project's Nix configuration.</p>
<h3 id="automatic-environment-activation"><a class="header" href="#automatic-environment-activation">Automatic Environment Activation</a></h3>
<p>With <code>direnv</code> properly set up, the Nix environment will automatically activate when you enter the project directory and deactivate when you leave it. This ensures that you're always using the correct versions of tools and dependencies for the GreenFlow project.</p>
<h3 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h3>
<p>If you encounter any issues during the setup process:</p>
<ol>
<li>Ensure that Nix and direnv are correctly installed and configured.</li>
<li>Check that your <code>.envrc</code> file is properly set up and allowed by direnv.</li>
<li>If changes are made to the Nix configuration, you may need to run <code>nix develop</code> again to update the environment.</li>
</ol>
<h3 id="flakenix-configuration"><a class="header" href="#flakenix-configuration">flake.nix Configuration</a></h3>
<p>The <code>flake.nix</code> file in the project root provides a clear definition of the dependencies and environment setup for the GreenFlow project. It includes:</p>
<ul>
<li><strong>Nix Packages</strong>: A list of packages required for the project, such as <code>micromamba</code>, <code>kubectl</code>, <code>kubernetes-helm</code>, and more.</li>
<li><strong>Scripts</strong>: Scripts for resetting the environment and setting up dependencies.</li>
<li><strong>Environment Variables</strong>: Configuration for environment variables and shell hooks.</li>
</ul>
<p>This configuration ensures that all necessary tools and dependencies are available and correctly set up for the GreenFlow project.</p>
<h3 id="additional-tools"><a class="header" href="#additional-tools">Additional Tools</a></h3>
<p>If you do not have networking access to expose your local experiment machine to the Kubernetes cluster, you will need to set up Tailscale, Caddy, Victoria Metrics, and Grafana using Docker Compose from <code>$PROJECT_ROOT/deploy</code> <a href="./prometheus-setup.html">here</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="overview.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="overview.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
